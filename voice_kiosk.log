2025-10-16 20:12:38 - root - [INFO] - logging_config.py:61 - ================================================================================
2025-10-16 20:12:38 - root - [INFO] - logging_config.py:62 - Voice Kiosk Application Starting - 2025-10-16 20:12:38
2025-10-16 20:12:38 - root - [INFO] - logging_config.py:63 - Log level: INFO
2025-10-16 20:12:38 - root - [INFO] - logging_config.py:64 - ================================================================================
2025-10-16 20:12:38 - root - [INFO] - main_new.py:27 - Initializing Eel framework
2025-10-16 20:12:38 - root - [INFO] - main_new.py:681 - ================================================================================
2025-10-16 20:12:38 - root - [INFO] - main_new.py:682 - VOICE KIOSK APPLICATION STARTING
2025-10-16 20:12:38 - root - [INFO] - main_new.py:683 - ================================================================================
2025-10-16 20:12:38 - root - [INFO] - main_new.py:688 - Main event loop created: <_UnixSelectorEventLoop running=False closed=False debug=False>
2025-10-16 20:12:38 - root - [INFO] - main_new.py:698 - Starting event loop in background thread
2025-10-16 20:12:38 - root - [INFO] - main_new.py:704 - Event loop thread started
2025-10-16 20:12:38 - root - [INFO] - main_new.py:653 - Starting async_main()
2025-10-16 20:12:38 - root - [INFO] - main_new.py:73 - ================================================================================
2025-10-16 20:12:38 - root - [INFO] - main_new.py:74 - VOICE KIOSK APPLICATION INITIALIZATION
2025-10-16 20:12:38 - root - [INFO] - main_new.py:75 - ================================================================================
2025-10-16 20:12:38 - root - [INFO] - main_new.py:79 - Validating configuration...
2025-10-16 20:12:38 - config - [INFO] - config.py:100 - Validating configuration...
2025-10-16 20:12:38 - config - [INFO] - config.py:113 - Recordings directory /tmp/voice_kiosk_recordings is writable
2025-10-16 20:12:38 - config - [INFO] - config.py:133 - Configuration validation passed
2025-10-16 20:12:38 - root - [INFO] - main_new.py:81 - Configuration validation passed
2025-10-16 20:12:38 - root - [INFO] - main_new.py:84 - Creating event loop coordinator...
2025-10-16 20:12:38 - event_loop - [INFO] - event_loop.py:32 - Initializing EventLoopCoordinator
2025-10-16 20:12:38 - event_loop - [INFO] - event_loop.py:43 - EventLoopCoordinator initialized
2025-10-16 20:12:38 - root - [INFO] - main_new.py:86 - Event loop coordinator created
2025-10-16 20:12:38 - root - [INFO] - main_new.py:136 - Registering state callbacks...
2025-10-16 20:12:38 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state IDLE: on_idle
2025-10-16 20:12:38 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state RECORDING: on_recording
2025-10-16 20:12:38 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state THINKING: on_thinking
2025-10-16 20:12:38 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state SPEAKING: on_speaking
2025-10-16 20:12:38 - root - [INFO] - main_new.py:163 - State callbacks registered
2025-10-16 20:12:38 - root - [INFO] - main_new.py:92 - Creating subsystem manager...
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:22 - Initializing SubsystemManager
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:38 - SubsystemManager initialized
2025-10-16 20:12:38 - root - [INFO] - main_new.py:94 - Subsystem manager created
2025-10-16 20:12:38 - root - [INFO] - main_new.py:97 - Initializing subsystems...
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:42 - ============================================================
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:43 - Starting subsystem initialization
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:44 - ============================================================
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:103 - Initializing Ollama client...
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:112 - Testing Ollama connection to http://localhost:11434
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:114 - Ollama client initialized successfully
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:127 - Initializing Tool Processor...
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-16 20:12:38 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:132 - Tool Processor initialized with 4 tools
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_weather
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: timenow
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: finished
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_fortune
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:149 - Initializing Whisper STT service...
2025-10-16 20:12:38 - whisper_service - [INFO] - whisper_service.py:25 - Initializing WhisperService with model: tiny.en
2025-10-16 20:12:38 - whisper_service - [INFO] - whisper_service.py:38 - Loading Whisper model: tiny.en
2025-10-16 20:12:38 - whisper_service - [INFO] - whisper_service.py:46 - Whisper model loaded successfully
2025-10-16 20:12:38 - whisper_service - [INFO] - whisper_service.py:34 - WhisperService initialized (device: cpu, compute_type: int8)
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:159 - Whisper service initialized (model: tiny.en)
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:172 - Initializing TTS engine...
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:190 - TTS engine initialized (pyttsx3, rate: 150)
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:207 - Initializing Audio Recorder...
2025-10-16 20:12:38 - audio_recorder - [INFO] - audio_recorder.py:33 - Initializing AudioRecorder
2025-10-16 20:12:38 - audio_recorder - [INFO] - audio_recorder.py:49 - AudioRecorder initialized: 48000Hz, silence threshold: 2000
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:221 - Audio Recorder initialized (48000Hz)
2025-10-16 20:12:38 - subsystem_manager - [INFO] - subsystem_manager.py:234 - Initializing Wake Word Detector...
2025-10-16 20:12:38 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:34 - Initializing Improved Wake Word Detector: 'hal'
2025-10-16 20:12:38 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:49 - Wake word variants: ['hal', 'how', 'hall', 'hell', 'hail', 'haul', 'owl', 'al', 'pal', 'cal']
2025-10-16 20:12:38 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:79 - Loading Vosk model from models/vosk-model-small-en-us-0.15
2025-10-16 20:12:39 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:90 - Vosk model loaded successfully
2025-10-16 20:12:39 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:54 - Improved detector initialized: amp=300.0x, threshold=0.6
2025-10-16 20:12:39 - subsystem_manager - [INFO] - subsystem_manager.py:261 - Wake Word Detector initialized (word: 'hal', amp: 300.0x, threshold: 0.6)
2025-10-16 20:12:39 - subsystem_manager - [INFO] - subsystem_manager.py:82 - All critical subsystems initialized successfully
2025-10-16 20:12:39 - subsystem_manager - [INFO] - subsystem_manager.py:95 - ============================================================
2025-10-16 20:12:39 - subsystem_manager - [INFO] - subsystem_manager.py:96 - Subsystem initialization complete. Ready: True
2025-10-16 20:12:39 - subsystem_manager - [INFO] - subsystem_manager.py:97 - ============================================================
2025-10-16 20:12:39 - root - [INFO] - main_new.py:104 - All subsystems initialized successfully
2025-10-16 20:12:39 - root - [INFO] - main_new.py:111 - Loading system prompts...
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-16 20:12:39 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-16 20:12:39 - root - [INFO] - main_new.py:113 - System prompts loaded (agent: qwen3:1.7b, conversation: gemma3:1b)
2025-10-16 20:12:39 - root - [INFO] - main_new.py:116 - Starting event loop coordinator...
2025-10-16 20:12:39 - event_loop - [INFO] - event_loop.py:159 - Creating background task: event_loop_coordinator
2025-10-16 20:12:39 - root - [INFO] - main_new.py:121 - Event loop coordinator started
2025-10-16 20:12:39 - root - [INFO] - main_new.py:123 - ================================================================================
2025-10-16 20:12:39 - root - [INFO] - main_new.py:124 - APPLICATION INITIALIZATION COMPLETE
2025-10-16 20:12:39 - root - [INFO] - main_new.py:125 - ================================================================================
2025-10-16 20:12:39 - root - [INFO] - main_new.py:662 - Application ready!
2025-10-16 20:12:39 - event_loop - [INFO] - event_loop.py:241 - Starting EventLoopCoordinator main loop
2025-10-16 20:12:39 - event_loop - [INFO] - event_loop.py:159 - Creating background task: screensaver_monitor
2025-10-16 20:12:39 - event_loop - [INFO] - event_loop.py:250 - EventLoopCoordinator running
2025-10-16 20:12:39 - event_loop - [INFO] - event_loop.py:189 - Starting screensaver monitor
2025-10-16 20:12:40 - root - [INFO] - main_new.py:712 - Starting Eel web interface...
2025-10-16 20:12:40 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:40] "GET /index.html HTTP/1.1" 200 689 0.001163
2025-10-16 20:12:40 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:40] "GET /eel.js HTTP/1.1" 200 6153 0.000544
2025-10-16 20:12:40 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:40] "GET /style.css HTTP/1.1" 200 3973 0.000493
2025-10-16 20:12:40 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:40] "GET /app.js HTTP/1.1" 200 4061 0.000562
2025-10-16 20:12:40 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:40] "GET /favicon.ico HTTP/1.1" 404 882 0.004227
2025-10-16 20:12:40 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:40] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002745
2025-10-16 20:12:44 - root - [INFO] - main_new.py:491 - Screen clicked in state: BOOT
2025-10-16 20:12:44 - root - [INFO] - main_new.py:519 - Starting boot sequence...
2025-10-16 20:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:44] "GET /assets/fonts/instrument-serif/instrument-serif-v4-latin-regular.woff2 HTTP/1.1" 404 940 0.001271
2025-10-16 20:12:45 - root - [INFO] - main_new.py:534 - Generating boot greeting...
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.002122
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.003457
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000767
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000796
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000764
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.005831
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000669
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001295
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000678
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001231
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000736
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002446
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000503
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000940
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000621
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000592
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000995
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001826
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000610
2025-10-16 20:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001761
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000656
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001983
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000643
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002857
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000562
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002266
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000595
2025-10-16 20:12:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:46] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.002137
2025-10-16 20:12:47 - event_loop - [INFO] - event_loop.py:72 - State transition: BOOT -> IDLE
2025-10-16 20:12:47 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-16 20:12:47 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-16 20:12:47 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-16 20:12:47 - subsystem_manager - [INFO] - subsystem_manager.py:282 - Starting wake word listener...
2025-10-16 20:12:47 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-16 20:12:47 - subsystem_manager - [INFO] - subsystem_manager.py:288 - Wake word listener started
2025-10-16 20:12:47 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-16 20:12:47 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-16 20:12:47 - root - [INFO] - main_new.py:562 - Boot sequence complete
2025-10-16 20:12:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-16 20:12:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-16 20:12:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:47] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002154
2025-10-16 20:12:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 300.0x
2025-10-16 20:12:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-16 20:12:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-16 20:12:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-16 20:12:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'what time is up'
2025-10-16 20:12:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-16 20:12:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:12:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-16 20:12:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:12:52 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:12:52 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-16 20:12:52 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:12:52 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-16 20:12:52 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-16 20:12:52 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-16 20:12:52 - subsystem_manager - [INFO] - subsystem_manager.py:299 - Stopping wake word listener...
2025-10-16 20:12:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-16 20:12:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-16 20:12:53 - subsystem_manager - [INFO] - subsystem_manager.py:302 - Wake word listener stopped
2025-10-16 20:12:53 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-16 20:12:53 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-16 20:12:53 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-16 20:12:53 - subsystem_manager - [INFO] - subsystem_manager.py:316 - Starting audio recording...
2025-10-16 20:12:53 - audio_recorder - [INFO] - audio_recorder.py:57 - Starting audio recording...
2025-10-16 20:12:53 - audio_recorder - [INFO] - audio_recorder.py:58 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-16 20:12:53 - audio_recorder - [INFO] - audio_recorder.py:67 - Output file: /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:53 - audio_recorder - [INFO] - audio_recorder.py:76 - Opening audio stream...
2025-10-16 20:12:53 - audio_recorder - [INFO] - audio_recorder.py:84 - Recording started - speak now...
2025-10-16 20:12:53 - audio_recorder - [INFO] - audio_recorder.py:111 - Silence detected (RMS: 0 < 2000)
2025-10-16 20:12:54 - audio_recorder - [INFO] - audio_recorder.py:115 - Silence duration threshold reached (1.53s), stopping recording
2025-10-16 20:12:54 - audio_recorder - [INFO] - audio_recorder.py:131 - Recording stopped
2025-10-16 20:12:54 - audio_recorder - [INFO] - audio_recorder.py:155 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:54 - audio_recorder - [INFO] - audio_recorder.py:161 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:54 - audio_recorder - [INFO] - audio_recorder.py:136 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760620373.wav (19 chunks)
2025-10-16 20:12:54 - audio_recorder - [INFO] - audio_recorder.py:147 - Recording cleanup complete
2025-10-16 20:12:54 - subsystem_manager - [INFO] - subsystem_manager.py:319 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:54 - root - [INFO] - main_new.py:229 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:54 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-16 20:12:54 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-16 20:12:54 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-16 20:12:54 - root - [INFO] - main_new.py:241 - Transcribing audio...
2025-10-16 20:12:54 - subsystem_manager - [INFO] - subsystem_manager.py:338 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:54 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:54] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001494
2025-10-16 20:12:54 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760620373.wav
2025-10-16 20:12:54 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:01.621
2025-10-16 20:12:54 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-16 20:12:56 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 1 segment(s), total length: 3 chars
2025-10-16 20:12:56 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: 'You'
2025-10-16 20:12:56 - subsystem_manager - [INFO] - subsystem_manager.py:341 - Transcription complete: 'You'
2025-10-16 20:12:56 - root - [INFO] - main_new.py:249 - Transcription complete: 'You'
2025-10-16 20:12:56 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:56] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001232
2025-10-16 20:12:56 - root - [INFO] - main_new.py:286 - ================================================================================
2025-10-16 20:12:56 - root - [INFO] - main_new.py:287 - Processing user input: 'You'
2025-10-16 20:12:56 - root - [INFO] - main_new.py:288 - ================================================================================
2025-10-16 20:12:56 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> THINKING
2025-10-16 20:12:56 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state THINKING
2025-10-16 20:12:56 - root - [INFO] - main_new.py:152 - Entered THINKING state
2025-10-16 20:12:56 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in THINKING
2025-10-16 20:12:56 - root - [INFO] - main_new.py:300 - Phase 1: Running agent loop...
2025-10-16 20:12:56 - root - [INFO] - main_new.py:315 - Starting agent loop...
2025-10-16 20:12:56 - root - [INFO] - main_new.py:321 - Agent prompt loaded
2025-10-16 20:12:56 - root - [INFO] - main_new.py:322 - Using model: qwen3:1.7b
2025-10-16 20:12:56 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:12:56] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001077
2025-10-16 20:13:19 - root - [INFO] - main_new.py:491 - Screen clicked in state: THINKING
2025-10-16 20:13:57 - ollama_client - [ERROR] - ollama_client.py:62 - Ollama request failed: 
2025-10-16 20:13:57 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: ('')
2025-10-16 20:13:57 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: ('')
2025-10-16 20:13:57 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: 
2025-10-16 20:14:58 - ollama_client - [ERROR] - ollama_client.py:62 - Ollama request failed: 
2025-10-16 20:14:58 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: ('')
2025-10-16 20:14:58 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: ('')
2025-10-16 20:14:58 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: 
2025-10-16 20:15:59 - ollama_client - [ERROR] - ollama_client.py:62 - Ollama request failed: 
2025-10-16 20:15:59 - tool_processor - [ERROR] - tool_processor.py:157 - Failed to parse tool call JSON
2025-10-16 20:15:59 - root - [INFO] - main_new.py:333 - Agent loop completed with result: Step 1: Unknown tool: 
Step 2: Unknown tool: 

2025-10-16 20:15:59 - root - [INFO] - main_new.py:302 - Agent loop complete. Result: Step 1: Unknown tool: 
Step 2: Unknown tool: 

2025-10-16 20:15:59 - root - [INFO] - main_new.py:305 - Phase 2: Generating conversation response...
2025-10-16 20:15:59 - root - [INFO] - main_new.py:343 - Generating conversation response...
2025-10-16 20:15:59 - event_loop - [INFO] - event_loop.py:72 - State transition: THINKING -> SPEAKING
2025-10-16 20:15:59 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state SPEAKING
2025-10-16 20:15:59 - root - [INFO] - main_new.py:156 - Entered SPEAKING state
2025-10-16 20:15:59 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in SPEAKING
2025-10-16 20:15:59 - root - [INFO] - main_new.py:371 - Streaming response from gemma3:1b...
2025-10-16 20:15:59 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:15:59] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.004959
2025-10-16 20:15:59 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:15:59] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002809
2025-10-16 20:16:20 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:20] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002969
2025-10-16 20:16:20 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:20] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.005837
2025-10-16 20:16:21 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:21] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000672
2025-10-16 20:16:21 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:21] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000616
2025-10-16 20:16:21 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:21] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000639
2025-10-16 20:16:21 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:21] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.005371
2025-10-16 20:16:22 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:22] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.003305
2025-10-16 20:16:22 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:22] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000827
2025-10-16 20:16:23 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:23] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000845
2025-10-16 20:16:23 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:23] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.005212
2025-10-16 20:16:23 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:23] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000676
2025-10-16 20:16:23 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:23] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000613
2025-10-16 20:16:23 - root - [INFO] - main_new.py:407 - Response complete. Feeling: interested
2025-10-16 20:16:23 - root - [INFO] - main_new.py:408 - Full message: your_response
2025-10-16 20:16:23 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:23] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.006615
2025-10-16 20:16:25 - event_loop - [INFO] - event_loop.py:72 - State transition: SPEAKING -> IDLE
2025-10-16 20:16:25 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-16 20:16:25 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-16 20:16:25 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-16 20:16:25 - subsystem_manager - [INFO] - subsystem_manager.py:282 - Starting wake word listener...
2025-10-16 20:16:25 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-16 20:16:25 - subsystem_manager - [INFO] - subsystem_manager.py:288 - Wake word listener started
2025-10-16 20:16:25 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-16 20:16:25 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-16 20:16:25 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:25] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001139
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 300.0x
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:16:26 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:16:26 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-16 20:16:26 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-16 20:16:26 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-16 20:16:26 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-16 20:16:26 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-16 20:16:26 - subsystem_manager - [INFO] - subsystem_manager.py:299 - Stopping wake word listener...
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-16 20:16:26 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-16 20:16:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-16 20:16:26 - subsystem_manager - [INFO] - subsystem_manager.py:302 - Wake word listener stopped
2025-10-16 20:16:26 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-16 20:16:26 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-16 20:16:26 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-16 20:16:26 - subsystem_manager - [INFO] - subsystem_manager.py:316 - Starting audio recording...
2025-10-16 20:16:26 - audio_recorder - [INFO] - audio_recorder.py:57 - Starting audio recording...
2025-10-16 20:16:26 - audio_recorder - [INFO] - audio_recorder.py:58 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-16 20:16:26 - audio_recorder - [INFO] - audio_recorder.py:67 - Output file: /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:26 - audio_recorder - [INFO] - audio_recorder.py:76 - Opening audio stream...
2025-10-16 20:16:26 - audio_recorder - [INFO] - audio_recorder.py:84 - Recording started - speak now...
2025-10-16 20:16:26 - audio_recorder - [INFO] - audio_recorder.py:111 - Silence detected (RMS: 0 < 2000)
2025-10-16 20:16:28 - audio_recorder - [INFO] - audio_recorder.py:115 - Silence duration threshold reached (1.53s), stopping recording
2025-10-16 20:16:28 - audio_recorder - [INFO] - audio_recorder.py:131 - Recording stopped
2025-10-16 20:16:28 - audio_recorder - [INFO] - audio_recorder.py:155 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:28 - audio_recorder - [INFO] - audio_recorder.py:161 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:28 - audio_recorder - [INFO] - audio_recorder.py:136 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760620586.wav (19 chunks)
2025-10-16 20:16:28 - audio_recorder - [INFO] - audio_recorder.py:147 - Recording cleanup complete
2025-10-16 20:16:28 - subsystem_manager - [INFO] - subsystem_manager.py:319 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:28 - root - [INFO] - main_new.py:229 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:28 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-16 20:16:28 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-16 20:16:28 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-16 20:16:28 - root - [INFO] - main_new.py:241 - Transcribing audio...
2025-10-16 20:16:28 - subsystem_manager - [INFO] - subsystem_manager.py:338 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:28 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760620586.wav
2025-10-16 20:16:28 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:28] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001533
2025-10-16 20:16:28 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:01.621
2025-10-16 20:16:28 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-16 20:16:30 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 1 segment(s), total length: 3 chars
2025-10-16 20:16:30 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: 'You'
2025-10-16 20:16:30 - subsystem_manager - [INFO] - subsystem_manager.py:341 - Transcription complete: 'You'
2025-10-16 20:16:30 - root - [INFO] - main_new.py:249 - Transcription complete: 'You'
2025-10-16 20:16:30 - root - [INFO] - main_new.py:286 - ================================================================================
2025-10-16 20:16:30 - root - [INFO] - main_new.py:287 - Processing user input: 'You'
2025-10-16 20:16:30 - root - [INFO] - main_new.py:288 - ================================================================================
2025-10-16 20:16:30 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> THINKING
2025-10-16 20:16:30 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state THINKING
2025-10-16 20:16:30 - root - [INFO] - main_new.py:152 - Entered THINKING state
2025-10-16 20:16:30 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in THINKING
2025-10-16 20:16:30 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:30] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.000558
2025-10-16 20:16:30 - root - [INFO] - main_new.py:300 - Phase 1: Running agent loop...
2025-10-16 20:16:30 - root - [INFO] - main_new.py:315 - Starting agent loop...
2025-10-16 20:16:30 - root - [INFO] - main_new.py:321 - Agent prompt loaded
2025-10-16 20:16:30 - root - [INFO] - main_new.py:322 - Using model: qwen3:1.7b
2025-10-16 20:16:30 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-16 20:16:30] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002680
2025-10-16 20:16:46 - root - [INFO] - main_new.py:728 - Shutting down event loop...
2025-10-16 20:16:46 - root - [INFO] - main_new.py:700 - Event loop stopped
2025-10-16 20:16:46 - root - [INFO] - main_new.py:731 - Application exit
2025-10-17 06:39:39 - root - [INFO] - logging_config.py:61 - ================================================================================
2025-10-17 06:39:39 - root - [INFO] - logging_config.py:62 - Voice Kiosk Application Starting - 2025-10-17 06:39:39
2025-10-17 06:39:39 - root - [INFO] - logging_config.py:63 - Log level: INFO
2025-10-17 06:39:39 - root - [INFO] - logging_config.py:64 - ================================================================================
2025-10-17 06:39:39 - root - [INFO] - main_new.py:27 - Initializing Eel framework
2025-10-17 06:39:39 - root - [INFO] - main_new.py:681 - ================================================================================
2025-10-17 06:39:39 - root - [INFO] - main_new.py:682 - VOICE KIOSK APPLICATION STARTING
2025-10-17 06:39:39 - root - [INFO] - main_new.py:683 - ================================================================================
2025-10-17 06:39:39 - root - [INFO] - main_new.py:688 - Main event loop created: <_UnixSelectorEventLoop running=False closed=False debug=False>
2025-10-17 06:39:39 - root - [INFO] - main_new.py:698 - Starting event loop in background thread
2025-10-17 06:39:39 - root - [INFO] - main_new.py:704 - Event loop thread started
2025-10-17 06:39:39 - root - [INFO] - main_new.py:653 - Starting async_main()
2025-10-17 06:39:39 - root - [INFO] - main_new.py:73 - ================================================================================
2025-10-17 06:39:39 - root - [INFO] - main_new.py:74 - VOICE KIOSK APPLICATION INITIALIZATION
2025-10-17 06:39:39 - root - [INFO] - main_new.py:75 - ================================================================================
2025-10-17 06:39:39 - root - [INFO] - main_new.py:79 - Validating configuration...
2025-10-17 06:39:39 - config - [INFO] - config.py:100 - Validating configuration...
2025-10-17 06:39:39 - config - [INFO] - config.py:113 - Recordings directory /tmp/voice_kiosk_recordings is writable
2025-10-17 06:39:39 - config - [INFO] - config.py:133 - Configuration validation passed
2025-10-17 06:39:39 - root - [INFO] - main_new.py:81 - Configuration validation passed
2025-10-17 06:39:39 - root - [INFO] - main_new.py:84 - Creating event loop coordinator...
2025-10-17 06:39:39 - event_loop - [INFO] - event_loop.py:32 - Initializing EventLoopCoordinator
2025-10-17 06:39:39 - event_loop - [INFO] - event_loop.py:43 - EventLoopCoordinator initialized
2025-10-17 06:39:39 - root - [INFO] - main_new.py:86 - Event loop coordinator created
2025-10-17 06:39:39 - root - [INFO] - main_new.py:136 - Registering state callbacks...
2025-10-17 06:39:39 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state IDLE: on_idle
2025-10-17 06:39:39 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state RECORDING: on_recording
2025-10-17 06:39:39 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state THINKING: on_thinking
2025-10-17 06:39:39 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state SPEAKING: on_speaking
2025-10-17 06:39:39 - root - [INFO] - main_new.py:163 - State callbacks registered
2025-10-17 06:39:39 - root - [INFO] - main_new.py:92 - Creating subsystem manager...
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:22 - Initializing SubsystemManager
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:38 - SubsystemManager initialized
2025-10-17 06:39:39 - root - [INFO] - main_new.py:94 - Subsystem manager created
2025-10-17 06:39:39 - root - [INFO] - main_new.py:97 - Initializing subsystems...
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:42 - ============================================================
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:43 - Starting subsystem initialization
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:44 - ============================================================
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:103 - Initializing Ollama client...
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:112 - Testing Ollama connection to http://localhost:11434
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:114 - Ollama client initialized successfully
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:127 - Initializing Tool Processor...
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-17 06:39:39 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:132 - Tool Processor initialized with 4 tools
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_weather
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: timenow
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: finished
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_fortune
2025-10-17 06:39:39 - subsystem_manager - [INFO] - subsystem_manager.py:149 - Initializing Whisper STT service...
2025-10-17 06:39:39 - whisper_service - [INFO] - whisper_service.py:25 - Initializing WhisperService with model: tiny.en
2025-10-17 06:39:39 - whisper_service - [INFO] - whisper_service.py:38 - Loading Whisper model: tiny.en
2025-10-17 06:39:40 - whisper_service - [INFO] - whisper_service.py:46 - Whisper model loaded successfully
2025-10-17 06:39:40 - whisper_service - [INFO] - whisper_service.py:34 - WhisperService initialized (device: cpu, compute_type: int8)
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:159 - Whisper service initialized (model: tiny.en)
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:172 - Initializing TTS engine...
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:190 - TTS engine initialized (pyttsx3, rate: 150)
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:207 - Initializing Audio Recorder...
2025-10-17 06:39:40 - audio_recorder - [INFO] - audio_recorder.py:37 - Initializing AudioRecorder
2025-10-17 06:39:40 - audio_recorder - [INFO] - audio_recorder.py:55 - AudioRecorder initialized: 48000Hz, device: 2, amp: 2.0x, silence threshold: 2000
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:223 - Audio Recorder initialized (48000Hz, device: 2, amp: 2.0x)
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:236 - Initializing Wake Word Detector...
2025-10-17 06:39:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:34 - Initializing Improved Wake Word Detector: 'hal'
2025-10-17 06:39:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:49 - Wake word variants: ['hal', 'how', 'hall', 'hell', 'hail', 'haul', 'owl', 'al', 'pal', 'cal']
2025-10-17 06:39:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:79 - Loading Vosk model from models/vosk-model-small-en-us-0.15
2025-10-17 06:39:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:90 - Vosk model loaded successfully
2025-10-17 06:39:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:54 - Improved detector initialized: amp=2.0x, threshold=0.6
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:263 - Wake Word Detector initialized (word: 'hal', amp: 2.0x, threshold: 0.6)
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:82 - All critical subsystems initialized successfully
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:95 - ============================================================
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:96 - Subsystem initialization complete. Ready: True
2025-10-17 06:39:40 - subsystem_manager - [INFO] - subsystem_manager.py:97 - ============================================================
2025-10-17 06:39:40 - root - [INFO] - main_new.py:104 - All subsystems initialized successfully
2025-10-17 06:39:40 - root - [INFO] - main_new.py:111 - Loading system prompts...
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-17 06:39:40 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-17 06:39:40 - root - [INFO] - main_new.py:113 - System prompts loaded (agent: qwen3:1.7b, conversation: gemma3:1b)
2025-10-17 06:39:40 - root - [INFO] - main_new.py:116 - Starting event loop coordinator...
2025-10-17 06:39:40 - event_loop - [INFO] - event_loop.py:159 - Creating background task: event_loop_coordinator
2025-10-17 06:39:40 - root - [INFO] - main_new.py:121 - Event loop coordinator started
2025-10-17 06:39:40 - root - [INFO] - main_new.py:123 - ================================================================================
2025-10-17 06:39:40 - root - [INFO] - main_new.py:124 - APPLICATION INITIALIZATION COMPLETE
2025-10-17 06:39:40 - root - [INFO] - main_new.py:125 - ================================================================================
2025-10-17 06:39:40 - root - [INFO] - main_new.py:662 - Application ready!
2025-10-17 06:39:40 - event_loop - [INFO] - event_loop.py:241 - Starting EventLoopCoordinator main loop
2025-10-17 06:39:40 - event_loop - [INFO] - event_loop.py:159 - Creating background task: screensaver_monitor
2025-10-17 06:39:40 - event_loop - [INFO] - event_loop.py:250 - EventLoopCoordinator running
2025-10-17 06:39:40 - event_loop - [INFO] - event_loop.py:189 - Starting screensaver monitor
2025-10-17 06:39:41 - root - [INFO] - main_new.py:712 - Starting Eel web interface...
2025-10-17 06:39:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:42] "GET /index.html HTTP/1.1" 200 689 0.001393
2025-10-17 06:39:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:42] "GET /style.css HTTP/1.1" 200 3973 0.002152
2025-10-17 06:39:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:42] "GET /eel.js HTTP/1.1" 200 6153 0.001933
2025-10-17 06:39:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:42] "GET /app.js HTTP/1.1" 200 4061 0.000724
2025-10-17 06:39:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:42] "GET /favicon.ico HTTP/1.1" 404 882 0.005182
2025-10-17 06:39:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:42] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001780
2025-10-17 06:39:46 - root - [INFO] - main_new.py:491 - Screen clicked in state: BOOT
2025-10-17 06:39:46 - root - [INFO] - main_new.py:519 - Starting boot sequence...
2025-10-17 06:39:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:46] "GET /assets/fonts/instrument-serif/instrument-serif-v4-latin-regular.woff2 HTTP/1.1" 404 940 0.001717
2025-10-17 06:39:47 - root - [INFO] - main_new.py:534 - Generating boot greeting...
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001887
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001690
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001468
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000923
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000588
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000656
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000593
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001801
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000767
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001758
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000749
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001320
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000687
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.003660
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000484
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.003265
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000651
2025-10-17 06:39:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:47] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.002645
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000667
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001833
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000690
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001530
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000605
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000643
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000605
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.002481
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000751
2025-10-17 06:39:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:48] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001639
2025-10-17 06:39:49 - event_loop - [INFO] - event_loop.py:72 - State transition: BOOT -> IDLE
2025-10-17 06:39:49 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:39:49 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:39:49 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:39:49 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:39:49 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:39:49 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:39:49 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:39:49 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:39:49 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:49] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001939
2025-10-17 06:39:49 - root - [INFO] - main_new.py:562 - Boot sequence complete
2025-10-17 06:39:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:39:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:39:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:39:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:39:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:39:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:39:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:39:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:39:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:51 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:51 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:39:51 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:51 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:39:51 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:39:51 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:39:51 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:39:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:39:51 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:39:51 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:39:51 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:39:51 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:39:51 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:39:51 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:39:51 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:39:51 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:39:51 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760657991.wav
2025-10-17 06:39:51 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:39:52 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:39:52 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:39:52 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:39:52 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:39:52 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:39:52 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:52] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.003265
2025-10-17 06:39:52 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:39:52 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:39:52 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:39:52 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:39:52 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:39:52 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:39:52 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:39:52 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:39:52 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:39:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:53 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:53 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:39:53 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:53 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:39:53 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:39:53 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:39:53 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:39:53 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:39:53 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:39:53 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:39:53 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:39:53 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:39:53 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:39:53 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:39:53 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:39:53 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:39:53 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760657993.wav
2025-10-17 06:39:53 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:39:54 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:39:54 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:39:54 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:39:54 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:39:54 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:39:54 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:39:54 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:39:54 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:39:54 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:39:54 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:39:54 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:54] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002002
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:54 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:54 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:39:54 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:39:54 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:39:54 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:39:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:39:54 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:39:54 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:39:54 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:39:54 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:39:54 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:39:54 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:39:54 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:39:54 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760657994.wav
2025-10-17 06:39:54 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:39:55 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:39:55 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:39:55 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:39:55 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:39:55 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:39:55 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:39:55 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:39:55 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:39:55 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:39:55 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:39:55 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:39:55 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:39:55 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:39:55 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:39:55 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:55] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002286
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:56 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:56 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:39:56 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:56 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:39:56 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:39:56 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:39:56 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:39:56 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:39:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:39:56 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:39:56 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:39:56 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:39:56 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:39:56 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:39:56 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:39:56 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:39:56 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760657996.wav
2025-10-17 06:39:56 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:39:57 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:39:57 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:39:57 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:39:57 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:39:57 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:39:57 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:39:57 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:39:57 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:39:57 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:39:57 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:39:57 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:57] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002643
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'hell'
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'hell'
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:57 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:57 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:39:57 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:39:57 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:39:57 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:39:57 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:39:57 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:39:57 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:39:57 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:39:57 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:39:57 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:39:57 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:39:57 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:39:57 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760657997.wav
2025-10-17 06:39:57 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:39:58 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:39:58 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:39:58 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:39:58 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:39:58 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:39:58 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:39:58 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:39:58 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:39:58 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:39:58 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:39:58 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:39:58 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:39:58 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:39:58 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:39:58 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:39:58] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002840
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:39:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'time is it'
2025-10-17 06:39:59 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:05 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:05 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:05 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:05 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:05 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:05 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:05 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:05 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:05 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:05 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:05 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:05 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:05 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:05 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:05 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658005.wav
2025-10-17 06:40:05 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:06 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:06 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:06 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:06 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:06 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:06 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:06 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:06 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:06 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:06 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:06 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:06] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.006404
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:06 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:06 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:06 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:06 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:06 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:06 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:06 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:07 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:07 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:07 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:07 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:07 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:07 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658007.wav
2025-10-17 06:40:07 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:08 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:08 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:08 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:08 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:08 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:08 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:08 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:08 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:08 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:08 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:08 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:08] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002413
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:08 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:08 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:08 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:08 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:08 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:08 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:08 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:08 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:08 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:08 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:08 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:08 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:08 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658008.wav
2025-10-17 06:40:08 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:09 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:09 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:09 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:09 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:09 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:09 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:09 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:09 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:09 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:09 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:09 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:09 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:09 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:09 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:09 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:09] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.004928
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'hell'
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'hell'
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:10 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:10 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:10 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:10 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:10 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:10 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:10 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:10 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:10 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:10 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:10 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:10 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:10 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:10 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:10 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:10 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658010.wav
2025-10-17 06:40:10 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:11 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:11 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:11 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:11 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:11 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:11 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:11 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:11 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:11 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:11 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:11 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:11 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:11 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:11] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.004610
2025-10-17 06:40:11 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:11 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:11 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'it's to plus'
2025-10-17 06:40:12 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:23 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:23 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:23 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:23 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:23 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:23 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:23 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:23 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:23 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:23 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:23 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:23 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:23 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:23 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:23 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:23 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:23 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:23 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:23 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:23 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:23 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658023.wav
2025-10-17 06:40:23 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:25 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:25 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:25 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:25 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:25 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:25 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:25] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001317
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:25 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:25 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:25 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:25 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:25 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:25 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:25 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:25 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:25 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:25 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:25 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:25 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:25 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:25 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:25 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:25 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:25 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:25 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658025.wav
2025-10-17 06:40:25 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:26 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:26 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:26 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:26 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:26 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:26 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:26 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:26] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001963
2025-10-17 06:40:26 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:26 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:26 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:26 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:26 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:26 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:26 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:26 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:26 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:26 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:26 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:26 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:26 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:26 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:26 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:26 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:26 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658026.wav
2025-10-17 06:40:26 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:27 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:28 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:28 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:28 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:28 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:28 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:28 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:28 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:28 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:28 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:28 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:28] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002172
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:28 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:28 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:28 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:28 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:28 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:28 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:28 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:28 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:28 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:28 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:28 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:28 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:28 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:28 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658028.wav
2025-10-17 06:40:28 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:29 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:29 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:29 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:29 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:29 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:29 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:29] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001165
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:29 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:29 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:29 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:29 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:29 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'hell'
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'hell'
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:29 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:29 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:29 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:29 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:29 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:29 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:29 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:29 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:29 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:29 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:29 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:29 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:29 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:29 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658029.wav
2025-10-17 06:40:29 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:30 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:30 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:30 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:30 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:30 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:30 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:30 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:30 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:30 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:30 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:30 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:30 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:30 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:30 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:30 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:30] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001201
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:30 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:31 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:31 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'dude'
2025-10-17 06:40:31 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'oh'
2025-10-17 06:40:43 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:43 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:43 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 06:40:43 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:43 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:43 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:43 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:43 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:43 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:43 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:43 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:43 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:43 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:43 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:43 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:43 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:43 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:43 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:43 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:43 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:43 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658043.wav
2025-10-17 06:40:43 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:44 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:44 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:44 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:44 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:44 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:44 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:44 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:44 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:44 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:44 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:44] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002260
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:44 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:44 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:44 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:44 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:44 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:44 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:45 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:45 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:45 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:45 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:45 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:45 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:45 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:45 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:45 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658045.wav
2025-10-17 06:40:45 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:46 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:46 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:46 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:46 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:46 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:46 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:46] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002029
2025-10-17 06:40:46 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:46 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:46 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:46 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:46 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:46 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:46 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:46 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:46 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:46 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:46 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:46 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:46 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:46 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:46 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:46 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:46 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:46 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658046.wav
2025-10-17 06:40:46 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:47 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:47 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:47 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:47 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:47 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:47] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.003595
2025-10-17 06:40:47 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:47 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:47 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:47 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:47 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:47 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:47 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:47 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:47 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:47 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:47 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:47 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:47 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:47 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:47 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:47 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:47 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:47 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658047.wav
2025-10-17 06:40:47 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:49 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:49 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:49 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:49 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:49 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:49 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:49 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:49 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:49 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:49 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:49 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:49] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.003509
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'hell'
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'hell'
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:49 - root - [INFO] - main_new.py:183 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:49 - root - [INFO] - main_new.py:184 - WAKE WORD DETECTED!
2025-10-17 06:40:49 - root - [INFO] - main_new.py:185 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 06:40:49 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 06:40:49 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 06:40:49 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 06:40:49 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 06:40:49 - root - [INFO] - main_new.py:217 - Starting audio recording process...
2025-10-17 06:40:49 - root - [INFO] - main_new.py:221 - Recording audio...
2025-10-17 06:40:49 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 06:40:49 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 06:40:49 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 06:40:49 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760658049.wav
2025-10-17 06:40:49 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 06:40:50 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 06:40:50 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 06:40:50 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 06:40:50 - root - [ERROR] - main_new.py:225 - Recording failed - no audio file returned
2025-10-17 06:40:50 - root - [ERROR] - main_new.py:266 - Recording error: Recording failed
2025-10-17 06:40:50 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 06:40:50 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 06:40:50 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 06:40:50 - root - [INFO] - main_new.py:178 - Starting wake word listener...
2025-10-17 06:40:50 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 06:40:50 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 06:40:50 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 06:40:50 - root - [INFO] - main_new.py:205 - Wake word listener started successfully
2025-10-17 06:40:50 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 06:40:50 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 06:40:50] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.003425
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 06:40:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'plus two'
2025-10-17 06:40:51 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 06:40:59 - root - [INFO] - main_new.py:728 - Shutting down event loop...
2025-10-17 06:40:59 - root - [INFO] - main_new.py:700 - Event loop stopped
2025-10-17 06:40:59 - root - [INFO] - main_new.py:731 - Application exit
2025-10-17 07:05:36 - root - [INFO] - logging_config.py:61 - ================================================================================
2025-10-17 07:05:36 - root - [INFO] - logging_config.py:62 - Voice Kiosk Application Starting - 2025-10-17 07:05:36
2025-10-17 07:05:36 - root - [INFO] - logging_config.py:63 - Log level: INFO
2025-10-17 07:05:36 - root - [INFO] - logging_config.py:64 - ================================================================================
2025-10-17 07:05:36 - root - [INFO] - main_new.py:27 - Initializing Eel framework
2025-10-17 07:05:36 - root - [INFO] - main_new.py:686 - ================================================================================
2025-10-17 07:05:36 - root - [INFO] - main_new.py:687 - VOICE KIOSK APPLICATION STARTING
2025-10-17 07:05:36 - root - [INFO] - main_new.py:688 - ================================================================================
2025-10-17 07:05:36 - root - [INFO] - main_new.py:693 - Main event loop created: <_UnixSelectorEventLoop running=False closed=False debug=False>
2025-10-17 07:05:36 - root - [INFO] - main_new.py:703 - Starting event loop in background thread
2025-10-17 07:05:36 - root - [INFO] - main_new.py:709 - Event loop thread started
2025-10-17 07:05:36 - root - [INFO] - main_new.py:658 - Starting async_main()
2025-10-17 07:05:36 - root - [INFO] - main_new.py:73 - ================================================================================
2025-10-17 07:05:36 - root - [INFO] - main_new.py:74 - VOICE KIOSK APPLICATION INITIALIZATION
2025-10-17 07:05:36 - root - [INFO] - main_new.py:75 - ================================================================================
2025-10-17 07:05:36 - root - [INFO] - main_new.py:79 - Validating configuration...
2025-10-17 07:05:36 - config - [INFO] - config.py:102 - Validating configuration...
2025-10-17 07:05:36 - config - [INFO] - config.py:115 - Recordings directory /tmp/voice_kiosk_recordings is writable
2025-10-17 07:05:36 - config - [INFO] - config.py:135 - Configuration validation passed
2025-10-17 07:05:36 - root - [INFO] - main_new.py:81 - Configuration validation passed
2025-10-17 07:05:36 - root - [INFO] - main_new.py:84 - Creating event loop coordinator...
2025-10-17 07:05:36 - event_loop - [INFO] - event_loop.py:32 - Initializing EventLoopCoordinator
2025-10-17 07:05:36 - event_loop - [INFO] - event_loop.py:43 - EventLoopCoordinator initialized
2025-10-17 07:05:36 - root - [INFO] - main_new.py:86 - Event loop coordinator created
2025-10-17 07:05:36 - root - [INFO] - main_new.py:136 - Registering state callbacks...
2025-10-17 07:05:36 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state IDLE: on_idle
2025-10-17 07:05:36 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state RECORDING: on_recording
2025-10-17 07:05:36 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state THINKING: on_thinking
2025-10-17 07:05:36 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state SPEAKING: on_speaking
2025-10-17 07:05:36 - root - [INFO] - main_new.py:168 - State callbacks registered
2025-10-17 07:05:36 - root - [INFO] - main_new.py:92 - Creating subsystem manager...
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:22 - Initializing SubsystemManager
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:38 - SubsystemManager initialized
2025-10-17 07:05:36 - root - [INFO] - main_new.py:94 - Subsystem manager created
2025-10-17 07:05:36 - root - [INFO] - main_new.py:97 - Initializing subsystems...
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:42 - ============================================================
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:43 - Starting subsystem initialization
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:44 - ============================================================
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:103 - Initializing Ollama client...
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:112 - Testing Ollama connection to http://localhost:11434
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:114 - Ollama client initialized successfully
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:127 - Initializing Tool Processor...
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-17 07:05:36 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:132 - Tool Processor initialized with 4 tools
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_weather
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: timenow
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: finished
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_fortune
2025-10-17 07:05:36 - subsystem_manager - [INFO] - subsystem_manager.py:149 - Initializing Whisper STT service...
2025-10-17 07:05:36 - whisper_service - [INFO] - whisper_service.py:25 - Initializing WhisperService with model: tiny.en
2025-10-17 07:05:36 - whisper_service - [INFO] - whisper_service.py:38 - Loading Whisper model: tiny.en
2025-10-17 07:05:37 - whisper_service - [INFO] - whisper_service.py:46 - Whisper model loaded successfully
2025-10-17 07:05:37 - whisper_service - [INFO] - whisper_service.py:34 - WhisperService initialized (device: cpu, compute_type: int8)
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:159 - Whisper service initialized (model: tiny.en)
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:172 - Initializing TTS engine...
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:190 - TTS engine initialized (pyttsx3, rate: 150)
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:207 - Initializing Audio Recorder...
2025-10-17 07:05:37 - audio_recorder - [INFO] - audio_recorder.py:37 - Initializing AudioRecorder
2025-10-17 07:05:37 - audio_recorder - [INFO] - audio_recorder.py:55 - AudioRecorder initialized: 48000Hz, device: 2, amp: 2.0x, silence threshold: 2000
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:223 - Audio Recorder initialized (48000Hz, device: 2, amp: 2.0x)
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:236 - Initializing Wake Word Detector...
2025-10-17 07:05:37 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:34 - Initializing Improved Wake Word Detector: 'hal'
2025-10-17 07:05:37 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:49 - Wake word variants: ['hal', 'how', 'hall', 'hell', 'hail', 'haul', 'owl', 'al', 'pal', 'cal']
2025-10-17 07:05:37 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:79 - Loading Vosk model from models/vosk-model-small-en-us-0.15
2025-10-17 07:05:37 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:90 - Vosk model loaded successfully
2025-10-17 07:05:37 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:54 - Improved detector initialized: amp=2.0x, threshold=0.6
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:263 - Wake Word Detector initialized (word: 'hal', amp: 2.0x, threshold: 0.6)
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:82 - All critical subsystems initialized successfully
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:95 - ============================================================
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:96 - Subsystem initialization complete. Ready: True
2025-10-17 07:05:37 - subsystem_manager - [INFO] - subsystem_manager.py:97 - ============================================================
2025-10-17 07:05:37 - root - [INFO] - main_new.py:104 - All subsystems initialized successfully
2025-10-17 07:05:37 - root - [INFO] - main_new.py:111 - Loading system prompts...
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-17 07:05:37 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-17 07:05:37 - root - [INFO] - main_new.py:113 - System prompts loaded (agent: exaone3.5:2.4b, conversation: exaone3.5:2.4b)
2025-10-17 07:05:37 - root - [INFO] - main_new.py:116 - Starting event loop coordinator...
2025-10-17 07:05:37 - event_loop - [INFO] - event_loop.py:159 - Creating background task: event_loop_coordinator
2025-10-17 07:05:37 - root - [INFO] - main_new.py:121 - Event loop coordinator started
2025-10-17 07:05:37 - root - [INFO] - main_new.py:123 - ================================================================================
2025-10-17 07:05:37 - root - [INFO] - main_new.py:124 - APPLICATION INITIALIZATION COMPLETE
2025-10-17 07:05:37 - root - [INFO] - main_new.py:125 - ================================================================================
2025-10-17 07:05:37 - root - [INFO] - main_new.py:667 - Application ready!
2025-10-17 07:05:37 - event_loop - [INFO] - event_loop.py:241 - Starting EventLoopCoordinator main loop
2025-10-17 07:05:37 - event_loop - [INFO] - event_loop.py:159 - Creating background task: screensaver_monitor
2025-10-17 07:05:37 - event_loop - [INFO] - event_loop.py:250 - EventLoopCoordinator running
2025-10-17 07:05:37 - event_loop - [INFO] - event_loop.py:189 - Starting screensaver monitor
2025-10-17 07:05:38 - root - [INFO] - main_new.py:717 - Starting Eel web interface...
2025-10-17 07:05:39 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:39] "GET /index.html HTTP/1.1" 200 689 0.003123
2025-10-17 07:05:39 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:39] "GET /eel.js HTTP/1.1" 200 6153 0.000583
2025-10-17 07:05:39 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:39] "GET /style.css HTTP/1.1" 200 3973 0.000672
2025-10-17 07:05:39 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:39] "GET /app.js HTTP/1.1" 200 4061 0.001452
2025-10-17 07:05:39 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:39] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001438
2025-10-17 07:05:39 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:39] "GET /favicon.ico HTTP/1.1" 404 882 0.007944
2025-10-17 07:05:41 - root - [INFO] - main_new.py:496 - Screen clicked in state: BOOT
2025-10-17 07:05:41 - root - [INFO] - main_new.py:524 - Starting boot sequence...
2025-10-17 07:05:41 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:41] "GET /assets/fonts/instrument-serif/instrument-serif-v4-latin-regular.woff2 HTTP/1.1" 404 940 0.000666
2025-10-17 07:05:42 - root - [INFO] - main_new.py:539 - Generating boot greeting...
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001445
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000999
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000432
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000486
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000431
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000872
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000527
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001126
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000538
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001323
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000798
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001644
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000530
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002011
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000493
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000282
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000670
2025-10-17 07:05:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000570
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000507
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000610
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000604
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000659
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000722
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000915
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000625
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000540
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000509
2025-10-17 07:05:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:43] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000510
2025-10-17 07:05:44 - event_loop - [INFO] - event_loop.py:72 - State transition: BOOT -> IDLE
2025-10-17 07:05:44 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:05:44 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:05:44 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:05:44 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:05:44 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:05:44 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:05:44 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:05:44 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:05:44 - root - [INFO] - main_new.py:567 - Boot sequence complete
2025-10-17 07:05:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:05:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:05:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:05:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:05:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:05:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:44] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002120
2025-10-17 07:05:44 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:05:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:05:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:05:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:46 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:46 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:05:46 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:46 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:05:46 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:05:46 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:05:46 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:05:46 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:05:47 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:05:47 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:05:47 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:05:47 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:05:47 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:05:47 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:05:47 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:05:47 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:05:47 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:05:47 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:05:47 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659547.wav
2025-10-17 07:05:47 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:05:48 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:05:48 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:05:48 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:05:48 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:05:48 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:05:48 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:05:48 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:05:48 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:05:48 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:05:48 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:05:48 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:48] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001642
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:48 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:48 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:05:48 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:05:48 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:05:48 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:05:48 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:05:48 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:05:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:05:49 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:05:49 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:05:49 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:05:49 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:05:49 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:05:49 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:05:49 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:05:49 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:05:49 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:05:49 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659549.wav
2025-10-17 07:05:49 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:05:50 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:05:50 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:05:50 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:05:50 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:05:50 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:05:50 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:05:50 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:05:50 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:05:50 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:05:50 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:50] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.005263
2025-10-17 07:05:50 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:50 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:50 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:05:50 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:05:50 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:05:50 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:05:50 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:05:50 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:05:50 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:05:50 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:05:51 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:05:51 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:05:51 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:05:51 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:05:51 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:05:51 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:05:51 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:05:51 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659551.wav
2025-10-17 07:05:51 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:05:52 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:05:52 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:05:52 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:05:52 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:05:52 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:05:52 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:52] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.003539
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:05:52 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:05:52 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:05:52 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:05:52 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:05:52 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:52 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:52 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:05:52 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:05:52 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:05:52 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:05:52 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:05:52 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:05:52 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:05:52 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:05:53 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:05:53 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:05:53 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:05:53 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:05:53 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:05:53 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:05:53 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:05:53 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659553.wav
2025-10-17 07:05:53 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:05:54 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:05:54 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:05:54 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:05:54 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:05:54 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:05:54 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:05:54 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:05:54 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:05:54 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:05:54 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:05:54 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:54] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.004027
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'how'
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'how'
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:54 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:54 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:05:54 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:05:54 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:05:54 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:05:54 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:05:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:05:54 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:05:54 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:05:55 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:05:55 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:05:55 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:05:55 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:05:55 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:05:55 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:05:55 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:05:55 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659555.wav
2025-10-17 07:05:55 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:05:56 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:05:56 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:05:56 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:05:56 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:05:56 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:05:56 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:05:56 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:05:56 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:05:56 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:05:56 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:05:56 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:05:56 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:05:56 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:05:56 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:05:56 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:05:56] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002903
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:05:56 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'template i've'
2025-10-17 07:05:56 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:06:03 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 07:06:03 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:03 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 07:06:03 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:03 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:03 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:06:03 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:03 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:06:03 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:06:03 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:06:03 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:06:03 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:06:03 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:06:03 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:06:03 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:06:03 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:06:03 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:06:03 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:06:03 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:06:03 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:06:03 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:06:03 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:06:03 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659563.wav
2025-10-17 07:06:03 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:06:04 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:06:04 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:06:04 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:06:04 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:06:04 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:06:04 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:06:04 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:06:04 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:06:04 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:06:04 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:06:04 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:06:04] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.004210
2025-10-17 07:06:04 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:06:04 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:06:04 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:06:04 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:06:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:06:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:06:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:05 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:05 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:06:05 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:05 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:06:05 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:06:05 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:06:05 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:06:05 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:06:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:06:05 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:06:05 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:06:05 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:06:05 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:06:05 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:06:05 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:06:05 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:06:05 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:06:05 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:06:05 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659565.wav
2025-10-17 07:06:05 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:06:06 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:06:06 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:06:06 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:06:06 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:06:06 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:06:06 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:06:06 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:06:06 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:06:06 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:06:06 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:06:06 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:06:06] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001755
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:06 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:06 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:06:06 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:06:06 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:06:06 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:06:06 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:06:06 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:06:07 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:06:07 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:06:07 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:06:07 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:06:07 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:06:07 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:06:07 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:06:07 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:06:07 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:06:07 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:06:07 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659567.wav
2025-10-17 07:06:07 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:06:08 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:06:08 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:06:08 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:06:08 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:06:08 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:06:08 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:06:08 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:06:08] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002600
2025-10-17 07:06:08 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:06:08 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:06:08 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:06:08 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'hell'
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:08 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:08 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:06:08 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:06:08 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:06:08 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:06:08 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:06:08 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:06:08 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:06:08 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:06:09 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:06:09 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:06:09 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:06:09 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:06:09 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:06:09 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:06:09 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:06:09 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659569.wav
2025-10-17 07:06:09 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:06:10 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:06:10 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:06:10 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:06:10 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:06:10 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:06:10 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:06:10 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:06:10 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:06:10 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:06:10 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:06:10] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001288
2025-10-17 07:06:10 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'hell'
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'hell' is variant of 'hal'
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'hell'
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:10 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:10 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:06:10 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:06:10 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:06:10 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:06:10 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:06:10 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:257 - Wake word detector stopped
2025-10-17 07:06:10 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:06:10 - root - [INFO] - main_new.py:151 - Waiting 0.5s for audio device release...
2025-10-17 07:06:11 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:06:11 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:06:11 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:06:11 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:06:11 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:06:11 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:06:11 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:06:11 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659571.wav
2025-10-17 07:06:11 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:06:12 - audio_recorder - [ERROR] - audio_recorder.py:157 - Error during recording: Error opening InputStream: Device unavailable [PaErrorCode -9985]
Traceback (most recent call last):
  File "/home/hal/hal/voice-kiosk/audio_recorder.py", line 83, in record
    stream = sd.InputStream(
        device=self.audio_device,
    ...<2 lines>...
        dtype='int16'
    )
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 1440, in __init__
    _StreamBase.__init__(self, kind='input', wrap_callback='array',
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                         **_remove_self(locals()))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 909, in __init__
    _check(_lib.Pa_OpenStream(self._ptr, iparameters, oparameters,
    ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              samplerate, blocksize, stream_flags,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                              callback_ptr, userdata),
                              ^^^^^^^^^^^^^^^^^^^^^^^^
           f'Error opening {self.__class__.__name__}')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hal/hal/venv/lib/python3.13/site-packages/sounddevice.py", line 2804, in _check
    raise PortAudioError(errormsg, err)
sounddevice.PortAudioError: Error opening InputStream: Device unavailable [PaErrorCode -9985]
2025-10-17 07:06:12 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:06:12 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: None
2025-10-17 07:06:12 - root - [ERROR] - main_new.py:230 - Recording failed - no audio file returned
2025-10-17 07:06:12 - root - [ERROR] - main_new.py:271 - Recording error: Recording failed
2025-10-17 07:06:12 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> IDLE
2025-10-17 07:06:12 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:06:12 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:06:12 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:06:12 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:06:12 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:06:12 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:06:12 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:06:12] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.003765
2025-10-17 07:06:12 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:06:12 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:246 - Audio stream closed
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:06:12 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'but five'
2025-10-17 07:06:12 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:06:22 - root - [INFO] - main_new.py:733 - Shutting down event loop...
2025-10-17 07:06:22 - root - [INFO] - main_new.py:705 - Event loop stopped
2025-10-17 07:06:22 - root - [INFO] - main_new.py:736 - Application exit
2025-10-17 07:10:24 - root - [INFO] - logging_config.py:61 - ================================================================================
2025-10-17 07:10:24 - root - [INFO] - logging_config.py:62 - Voice Kiosk Application Starting - 2025-10-17 07:10:24
2025-10-17 07:10:24 - root - [INFO] - logging_config.py:63 - Log level: INFO
2025-10-17 07:10:24 - root - [INFO] - logging_config.py:64 - ================================================================================
2025-10-17 07:10:24 - root - [INFO] - main_new.py:27 - Initializing Eel framework
2025-10-17 07:10:24 - root - [INFO] - main_new.py:686 - ================================================================================
2025-10-17 07:10:24 - root - [INFO] - main_new.py:687 - VOICE KIOSK APPLICATION STARTING
2025-10-17 07:10:24 - root - [INFO] - main_new.py:688 - ================================================================================
2025-10-17 07:10:24 - root - [INFO] - main_new.py:693 - Main event loop created: <_UnixSelectorEventLoop running=False closed=False debug=False>
2025-10-17 07:10:24 - root - [INFO] - main_new.py:703 - Starting event loop in background thread
2025-10-17 07:10:24 - root - [INFO] - main_new.py:709 - Event loop thread started
2025-10-17 07:10:24 - root - [INFO] - main_new.py:658 - Starting async_main()
2025-10-17 07:10:24 - root - [INFO] - main_new.py:73 - ================================================================================
2025-10-17 07:10:24 - root - [INFO] - main_new.py:74 - VOICE KIOSK APPLICATION INITIALIZATION
2025-10-17 07:10:24 - root - [INFO] - main_new.py:75 - ================================================================================
2025-10-17 07:10:24 - root - [INFO] - main_new.py:79 - Validating configuration...
2025-10-17 07:10:24 - config - [INFO] - config.py:102 - Validating configuration...
2025-10-17 07:10:24 - config - [INFO] - config.py:115 - Recordings directory /tmp/voice_kiosk_recordings is writable
2025-10-17 07:10:24 - config - [INFO] - config.py:135 - Configuration validation passed
2025-10-17 07:10:24 - root - [INFO] - main_new.py:81 - Configuration validation passed
2025-10-17 07:10:24 - root - [INFO] - main_new.py:84 - Creating event loop coordinator...
2025-10-17 07:10:24 - event_loop - [INFO] - event_loop.py:32 - Initializing EventLoopCoordinator
2025-10-17 07:10:24 - event_loop - [INFO] - event_loop.py:43 - EventLoopCoordinator initialized
2025-10-17 07:10:24 - root - [INFO] - main_new.py:86 - Event loop coordinator created
2025-10-17 07:10:24 - root - [INFO] - main_new.py:136 - Registering state callbacks...
2025-10-17 07:10:24 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state IDLE: on_idle
2025-10-17 07:10:24 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state RECORDING: on_recording
2025-10-17 07:10:24 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state THINKING: on_thinking
2025-10-17 07:10:24 - event_loop - [INFO] - event_loop.py:125 - Registered callback for state SPEAKING: on_speaking
2025-10-17 07:10:24 - root - [INFO] - main_new.py:168 - State callbacks registered
2025-10-17 07:10:24 - root - [INFO] - main_new.py:92 - Creating subsystem manager...
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:22 - Initializing SubsystemManager
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:38 - SubsystemManager initialized
2025-10-17 07:10:24 - root - [INFO] - main_new.py:94 - Subsystem manager created
2025-10-17 07:10:24 - root - [INFO] - main_new.py:97 - Initializing subsystems...
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:42 - ============================================================
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:43 - Starting subsystem initialization
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:44 - ============================================================
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:103 - Initializing Ollama client...
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:112 - Testing Ollama connection to http://localhost:11434
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:114 - Ollama client initialized successfully
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:127 - Initializing Tool Processor...
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-17 07:10:24 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:132 - Tool Processor initialized with 4 tools
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_weather
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: timenow
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: finished
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:136 -   - Tool registered: get_fortune
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:149 - Initializing Whisper STT service...
2025-10-17 07:10:24 - whisper_service - [INFO] - whisper_service.py:25 - Initializing WhisperService with model: tiny.en
2025-10-17 07:10:24 - whisper_service - [INFO] - whisper_service.py:38 - Loading Whisper model: tiny.en
2025-10-17 07:10:24 - whisper_service - [INFO] - whisper_service.py:46 - Whisper model loaded successfully
2025-10-17 07:10:24 - whisper_service - [INFO] - whisper_service.py:34 - WhisperService initialized (device: cpu, compute_type: int8)
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:159 - Whisper service initialized (model: tiny.en)
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:172 - Initializing TTS engine...
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:190 - TTS engine initialized (pyttsx3, rate: 150)
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:207 - Initializing Audio Recorder...
2025-10-17 07:10:24 - audio_recorder - [INFO] - audio_recorder.py:37 - Initializing AudioRecorder
2025-10-17 07:10:24 - audio_recorder - [INFO] - audio_recorder.py:55 - AudioRecorder initialized: 48000Hz, device: 2, amp: 2.0x, silence threshold: 2000
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:223 - Audio Recorder initialized (48000Hz, device: 2, amp: 2.0x)
2025-10-17 07:10:24 - subsystem_manager - [INFO] - subsystem_manager.py:236 - Initializing Wake Word Detector...
2025-10-17 07:10:24 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:34 - Initializing Improved Wake Word Detector: 'hal'
2025-10-17 07:10:24 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:49 - Wake word variants: ['hal', 'how', 'hall', 'hell', 'hail', 'haul', 'owl', 'al', 'pal', 'cal']
2025-10-17 07:10:24 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:79 - Loading Vosk model from models/vosk-model-small-en-us-0.15
2025-10-17 07:10:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:90 - Vosk model loaded successfully
2025-10-17 07:10:25 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:54 - Improved detector initialized: amp=2.0x, threshold=0.6
2025-10-17 07:10:25 - subsystem_manager - [INFO] - subsystem_manager.py:263 - Wake Word Detector initialized (word: 'hal', amp: 2.0x, threshold: 0.6)
2025-10-17 07:10:25 - subsystem_manager - [INFO] - subsystem_manager.py:82 - All critical subsystems initialized successfully
2025-10-17 07:10:25 - subsystem_manager - [INFO] - subsystem_manager.py:95 - ============================================================
2025-10-17 07:10:25 - subsystem_manager - [INFO] - subsystem_manager.py:96 - Subsystem initialization complete. Ready: True
2025-10-17 07:10:25 - subsystem_manager - [INFO] - subsystem_manager.py:97 - ============================================================
2025-10-17 07:10:25 - root - [INFO] - main_new.py:104 - All subsystems initialized successfully
2025-10-17 07:10:25 - root - [INFO] - main_new.py:111 - Loading system prompts...
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:14 - Initializing ToolProcessor
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:20 - Loading tools from tools directory...
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:30 - Found 4 tool file(s)
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_weather - return the weather for a certain city
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: timenow - return the current date and time
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: finished - call this when you have completed the user's request
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:53 - Loaded tool: get_fortune - get a random fortune or quote
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:60 - Tool loading complete: 4 tool(s) loaded
2025-10-17 07:10:25 - tool_processor - [INFO] - tool_processor.py:16 - ToolProcessor initialized with 4 tools
2025-10-17 07:10:25 - root - [INFO] - main_new.py:113 - System prompts loaded (agent: exaone3.5:2.4b, conversation: exaone3.5:2.4b)
2025-10-17 07:10:25 - root - [INFO] - main_new.py:116 - Starting event loop coordinator...
2025-10-17 07:10:25 - event_loop - [INFO] - event_loop.py:159 - Creating background task: event_loop_coordinator
2025-10-17 07:10:25 - root - [INFO] - main_new.py:121 - Event loop coordinator started
2025-10-17 07:10:25 - root - [INFO] - main_new.py:123 - ================================================================================
2025-10-17 07:10:25 - root - [INFO] - main_new.py:124 - APPLICATION INITIALIZATION COMPLETE
2025-10-17 07:10:25 - root - [INFO] - main_new.py:125 - ================================================================================
2025-10-17 07:10:25 - root - [INFO] - main_new.py:667 - Application ready!
2025-10-17 07:10:25 - event_loop - [INFO] - event_loop.py:241 - Starting EventLoopCoordinator main loop
2025-10-17 07:10:25 - event_loop - [INFO] - event_loop.py:159 - Creating background task: screensaver_monitor
2025-10-17 07:10:25 - event_loop - [INFO] - event_loop.py:250 - EventLoopCoordinator running
2025-10-17 07:10:25 - event_loop - [INFO] - event_loop.py:189 - Starting screensaver monitor
2025-10-17 07:10:26 - root - [INFO] - main_new.py:717 - Starting Eel web interface...
2025-10-17 07:10:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:26] "GET /index.html HTTP/1.1" 200 689 0.000863
2025-10-17 07:10:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:26] "GET /style.css HTTP/1.1" 200 3973 0.000489
2025-10-17 07:10:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:26] "GET /app.js HTTP/1.1" 200 4061 0.000575
2025-10-17 07:10:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:26] "GET /eel.js HTTP/1.1" 200 6153 0.000520
2025-10-17 07:10:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:26] "GET /favicon.ico HTTP/1.1" 404 882 0.003366
2025-10-17 07:10:26 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:26] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001311
2025-10-17 07:10:31 - root - [INFO] - main_new.py:496 - Screen clicked in state: BOOT
2025-10-17 07:10:31 - root - [INFO] - main_new.py:524 - Starting boot sequence...
2025-10-17 07:10:31 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:31] "GET /assets/fonts/instrument-serif/instrument-serif-v4-latin-regular.woff2 HTTP/1.1" 404 940 0.001186
2025-10-17 07:10:32 - root - [INFO] - main_new.py:539 - Generating boot greeting...
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001783
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002673
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001037
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000924
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000425
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.003114
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000416
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001008
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000534
2025-10-17 07:10:32 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:32] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.002294
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000550
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000485
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001195
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000415
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000436
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001498
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000479
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001640
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000613
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.003554
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000579
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000464
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000494
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000729
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000752
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.001879
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000702
2025-10-17 07:10:33 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:33] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002913
2025-10-17 07:10:34 - event_loop - [INFO] - event_loop.py:72 - State transition: BOOT -> IDLE
2025-10-17 07:10:34 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:10:34 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:10:34 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:10:34 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:10:34 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:10:34 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:10:34 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:10:34 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:10:34 - root - [INFO] - main_new.py:567 - Boot sequence complete
2025-10-17 07:10:34 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:10:34 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:34] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001364
2025-10-17 07:10:34 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:10:34 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:10:34 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:10:34 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:10:35 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:10:40 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:10:40 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:10:40 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:10:40 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:10:40 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:10:40 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:10:40 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:260 - Closing audio stream...
2025-10-17 07:10:40 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:263 - Audio stream closed successfully
2025-10-17 07:10:41 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:269 - Wake word detector stopped
2025-10-17 07:10:41 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:10:41 - root - [INFO] - main_new.py:151 - Waiting 1.0s for audio device release...
2025-10-17 07:10:42 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:10:42 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:10:42 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:10:42 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:10:42 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:10:42 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:10:42 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:10:42 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:42 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:10:42 - audio_recorder - [INFO] - audio_recorder.py:91 - Recording started - speak now...
2025-10-17 07:10:42 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 558 < 2000)
2025-10-17 07:10:44 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 1077 < 2000)
2025-10-17 07:10:44 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 1402 < 2000)
2025-10-17 07:10:44 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 908 < 2000)
2025-10-17 07:10:45 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 1412 < 2000)
2025-10-17 07:10:45 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 1365 < 2000)
2025-10-17 07:10:47 - audio_recorder - [INFO] - audio_recorder.py:129 - Silence duration threshold reached (1.54s), stopping recording
2025-10-17 07:10:47 - audio_recorder - [INFO] - audio_recorder.py:145 - Recording stopped
2025-10-17 07:10:47 - audio_recorder - [INFO] - audio_recorder.py:169 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:47 - audio_recorder - [INFO] - audio_recorder.py:175 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:47 - audio_recorder - [INFO] - audio_recorder.py:150 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760659842.wav (59 chunks)
2025-10-17 07:10:47 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:10:47 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:47 - root - [INFO] - main_new.py:234 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:47 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-17 07:10:47 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-17 07:10:47 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-17 07:10:47 - root - [INFO] - main_new.py:246 - Transcribing audio...
2025-10-17 07:10:47 - subsystem_manager - [INFO] - subsystem_manager.py:340 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:47 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659842.wav
2025-10-17 07:10:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:47] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001320
2025-10-17 07:10:47 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:05.035
2025-10-17 07:10:47 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-17 07:10:49 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 1 segment(s), total length: 18 chars
2025-10-17 07:10:49 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: 'What is 10 plus 5?'
2025-10-17 07:10:49 - subsystem_manager - [INFO] - subsystem_manager.py:343 - Transcription complete: 'What is 10 plus 5?'
2025-10-17 07:10:49 - root - [INFO] - main_new.py:254 - Transcription complete: 'What is 10 plus 5?'
2025-10-17 07:10:49 - root - [INFO] - main_new.py:291 - ================================================================================
2025-10-17 07:10:49 - root - [INFO] - main_new.py:292 - Processing user input: 'What is 10 plus 5?'
2025-10-17 07:10:49 - root - [INFO] - main_new.py:293 - ================================================================================
2025-10-17 07:10:49 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> THINKING
2025-10-17 07:10:49 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state THINKING
2025-10-17 07:10:49 - root - [INFO] - main_new.py:157 - Entered THINKING state
2025-10-17 07:10:49 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in THINKING
2025-10-17 07:10:49 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:10:49] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001490
2025-10-17 07:10:49 - root - [INFO] - main_new.py:305 - Phase 1: Running agent loop...
2025-10-17 07:10:49 - root - [INFO] - main_new.py:320 - Starting agent loop...
2025-10-17 07:10:49 - root - [INFO] - main_new.py:326 - Agent prompt loaded
2025-10-17 07:10:49 - root - [INFO] - main_new.py:327 - Using model: exaone3.5:2.4b
2025-10-17 07:11:13 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: addition('10 + 5')
2025-10-17 07:11:13 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: addition('10 + 5')
2025-10-17 07:11:13 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: addition
2025-10-17 07:11:28 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: arithmetic('10 plus 5')
2025-10-17 07:11:28 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: arithmetic('10 plus 5')
2025-10-17 07:11:28 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: arithmetic
2025-10-17 07:11:43 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: arithmetic('10 + 5')
2025-10-17 07:11:43 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: arithmetic('10 + 5')
2025-10-17 07:11:43 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: arithmetic
2025-10-17 07:11:58 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: arithmetic('10 + 5')
2025-10-17 07:11:58 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: arithmetic('10 + 5')
2025-10-17 07:11:58 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: arithmetic
2025-10-17 07:12:14 - tool_processor - [INFO] - tool_processor.py:137 - Agent wants to call: arithmetic('10 + 5')
2025-10-17 07:12:14 - tool_processor - [INFO] - tool_processor.py:82 - Processing tool: arithmetic('10 + 5')
2025-10-17 07:12:14 - tool_processor - [WARNING] - tool_processor.py:93 - Unknown tool: arithmetic
2025-10-17 07:12:14 - root - [INFO] - main_new.py:338 - Agent loop completed with result: Step 1: Unknown tool: addition
Step 2: Unknown tool: arithmetic
Step 3: Unknown tool: arithmetic
Step 4: Unknown tool: arithmetic
Step 5: Unknown tool: arithmetic

2025-10-17 07:12:14 - root - [INFO] - main_new.py:307 - Agent loop complete. Result: Step 1: Unknown tool: addition
Step 2: Unknown tool: arithmetic
Step 3: Unknown tool: arithmetic
Step 4: Unknown tool: arithmetic
Step 5: Unknown tool: arithmetic

2025-10-17 07:12:14 - root - [INFO] - main_new.py:310 - Phase 2: Generating conversation response...
2025-10-17 07:12:14 - root - [INFO] - main_new.py:348 - Generating conversation response...
2025-10-17 07:12:14 - event_loop - [INFO] - event_loop.py:72 - State transition: THINKING -> SPEAKING
2025-10-17 07:12:14 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state SPEAKING
2025-10-17 07:12:14 - root - [INFO] - main_new.py:161 - Entered SPEAKING state
2025-10-17 07:12:14 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in SPEAKING
2025-10-17 07:12:14 - root - [INFO] - main_new.py:376 - Streaming response from exaone3.5:2.4b...
2025-10-17 07:12:14 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:14] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000719
2025-10-17 07:12:14 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:14] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.002766
2025-10-17 07:12:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:42] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.001099
2025-10-17 07:12:42 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:42] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000672
2025-10-17 07:12:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:43] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000653
2025-10-17 07:12:43 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:43] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.015001
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000700
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000835
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000512
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000502
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000777
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000655
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000783
2025-10-17 07:12:44 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:44] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000828
2025-10-17 07:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000724
2025-10-17 07:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.000687
2025-10-17 07:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:45] "GET /assets/speaking/still.png HTTP/1.1" 200 35967 0.000772
2025-10-17 07:12:45 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:45] "GET /assets/speaking/open1.png HTTP/1.1" 200 17206 0.003558
2025-10-17 07:12:47 - root - [INFO] - main_new.py:412 - Response complete. Feeling: proud
2025-10-17 07:12:47 - root - [INFO] - main_new.py:413 - Full message: The sum of ten plus five equals twenty.
2025-10-17 07:12:47 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:47] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.000902
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:72 - State transition: SPEAKING -> IDLE
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:12:49 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:12:49 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:12:49 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:12:49 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:12:49 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:12:49 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:49] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002632
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:49 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:49 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:12:49 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:12:49 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:12:49 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:260 - Closing audio stream...
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:263 - Audio stream closed successfully
2025-10-17 07:12:49 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:12:49 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:269 - Wake word detector stopped
2025-10-17 07:12:49 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:12:49 - root - [INFO] - main_new.py:151 - Waiting 1.0s for audio device release...
2025-10-17 07:12:50 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:12:50 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:12:50 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:12:50 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:12:50 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:12:50 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:12:50 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:12:50 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:50 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:12:50 - audio_recorder - [INFO] - audio_recorder.py:91 - Recording started - speak now...
2025-10-17 07:12:51 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 819 < 2000)
2025-10-17 07:12:52 - audio_recorder - [INFO] - audio_recorder.py:129 - Silence duration threshold reached (1.53s), stopping recording
2025-10-17 07:12:52 - audio_recorder - [INFO] - audio_recorder.py:145 - Recording stopped
2025-10-17 07:12:52 - audio_recorder - [INFO] - audio_recorder.py:169 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:52 - audio_recorder - [INFO] - audio_recorder.py:175 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:52 - audio_recorder - [INFO] - audio_recorder.py:150 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760659970.wav (19 chunks)
2025-10-17 07:12:52 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:12:52 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:52 - root - [INFO] - main_new.py:234 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:52 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-17 07:12:52 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-17 07:12:52 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-17 07:12:52 - root - [INFO] - main_new.py:246 - Transcribing audio...
2025-10-17 07:12:52 - subsystem_manager - [INFO] - subsystem_manager.py:340 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:52 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:52] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002216
2025-10-17 07:12:52 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659970.wav
2025-10-17 07:12:52 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:01.621
2025-10-17 07:12:52 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-17 07:12:54 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 0 segment(s), total length: 0 chars
2025-10-17 07:12:54 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: ''
2025-10-17 07:12:54 - subsystem_manager - [INFO] - subsystem_manager.py:343 - Transcription complete: ''
2025-10-17 07:12:54 - root - [ERROR] - main_new.py:250 - Transcription failed - no text returned
2025-10-17 07:12:54 - root - [ERROR] - main_new.py:271 - Recording error: Could not understand audio
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> IDLE
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:12:54 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:12:54 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:12:54 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:12:54 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:12:54 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:12:54 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:54] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.000586
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:54 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:54 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:12:54 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:12:54 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:12:54 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:12:54 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:260 - Closing audio stream...
2025-10-17 07:12:54 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:263 - Audio stream closed successfully
2025-10-17 07:12:55 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:269 - Wake word detector stopped
2025-10-17 07:12:55 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:12:55 - root - [INFO] - main_new.py:151 - Waiting 1.0s for audio device release...
2025-10-17 07:12:56 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:12:56 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:12:56 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:12:56 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:12:56 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:12:56 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:12:56 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:12:56 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:56 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:12:56 - audio_recorder - [INFO] - audio_recorder.py:91 - Recording started - speak now...
2025-10-17 07:12:56 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 565 < 2000)
2025-10-17 07:12:57 - audio_recorder - [INFO] - audio_recorder.py:129 - Silence duration threshold reached (1.53s), stopping recording
2025-10-17 07:12:57 - audio_recorder - [INFO] - audio_recorder.py:145 - Recording stopped
2025-10-17 07:12:57 - audio_recorder - [INFO] - audio_recorder.py:169 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:57 - audio_recorder - [INFO] - audio_recorder.py:175 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:57 - audio_recorder - [INFO] - audio_recorder.py:150 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760659976.wav (19 chunks)
2025-10-17 07:12:57 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:12:57 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:57 - root - [INFO] - main_new.py:234 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:57 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-17 07:12:57 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-17 07:12:57 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-17 07:12:57 - root - [INFO] - main_new.py:246 - Transcribing audio...
2025-10-17 07:12:57 - subsystem_manager - [INFO] - subsystem_manager.py:340 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:57 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659976.wav
2025-10-17 07:12:57 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:57] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002035
2025-10-17 07:12:57 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:01.621
2025-10-17 07:12:57 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-17 07:12:59 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 0 segment(s), total length: 0 chars
2025-10-17 07:12:59 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: ''
2025-10-17 07:12:59 - subsystem_manager - [INFO] - subsystem_manager.py:343 - Transcription complete: ''
2025-10-17 07:12:59 - root - [ERROR] - main_new.py:250 - Transcription failed - no text returned
2025-10-17 07:12:59 - root - [ERROR] - main_new.py:271 - Recording error: Could not understand audio
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> IDLE
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:12:59 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:12:59 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:12:59 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:12:59 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:12:59] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002663
2025-10-17 07:12:59 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:12:59 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:223 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:224 - WAKE WORD DETECTED (partial) from: 'how'
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:225 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:59 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:59 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:12:59 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:12:59 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:12:59 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:12:59 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:260 - Closing audio stream...
2025-10-17 07:12:59 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:263 - Audio stream closed successfully
2025-10-17 07:13:00 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:269 - Wake word detector stopped
2025-10-17 07:13:00 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:13:00 - root - [INFO] - main_new.py:151 - Waiting 1.0s for audio device release...
2025-10-17 07:13:01 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:13:01 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:13:01 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:13:01 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:13:01 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:13:01 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:13:01 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:13:01 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:01 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:13:01 - audio_recorder - [INFO] - audio_recorder.py:91 - Recording started - speak now...
2025-10-17 07:13:01 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 829 < 2000)
2025-10-17 07:13:02 - audio_recorder - [INFO] - audio_recorder.py:129 - Silence duration threshold reached (1.53s), stopping recording
2025-10-17 07:13:02 - audio_recorder - [INFO] - audio_recorder.py:145 - Recording stopped
2025-10-17 07:13:02 - audio_recorder - [INFO] - audio_recorder.py:169 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:02 - audio_recorder - [INFO] - audio_recorder.py:175 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:02 - audio_recorder - [INFO] - audio_recorder.py:150 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760659981.wav (19 chunks)
2025-10-17 07:13:02 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:13:02 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:02 - root - [INFO] - main_new.py:234 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:02 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-17 07:13:02 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-17 07:13:02 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-17 07:13:02 - root - [INFO] - main_new.py:246 - Transcribing audio...
2025-10-17 07:13:02 - subsystem_manager - [INFO] - subsystem_manager.py:340 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:02 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659981.wav
2025-10-17 07:13:02 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:13:02] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.002273
2025-10-17 07:13:02 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:01.621
2025-10-17 07:13:02 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-17 07:13:04 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 0 segment(s), total length: 0 chars
2025-10-17 07:13:04 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: ''
2025-10-17 07:13:04 - subsystem_manager - [INFO] - subsystem_manager.py:343 - Transcription complete: ''
2025-10-17 07:13:04 - root - [ERROR] - main_new.py:250 - Transcription failed - no text returned
2025-10-17 07:13:04 - root - [ERROR] - main_new.py:271 - Recording error: Could not understand audio
2025-10-17 07:13:04 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:13:04] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001245
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> IDLE
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:13:04 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:13:04 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:13:04 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:13:04 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:13:04 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:201 - Recognized: 'how'
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:127 - ✓ Variant match: 'how' is variant of 'hal'
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:205 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:206 - WAKE WORD DETECTED from: 'how'
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:207 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:13:04 - root - [INFO] - main_new.py:188 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:13:04 - root - [INFO] - main_new.py:189 - WAKE WORD DETECTED!
2025-10-17 07:13:04 - root - [INFO] - main_new.py:190 - !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> RECORDING
2025-10-17 07:13:04 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state RECORDING
2025-10-17 07:13:04 - root - [INFO] - main_new.py:145 - Entered RECORDING state
2025-10-17 07:13:04 - subsystem_manager - [INFO] - subsystem_manager.py:301 - Stopping wake word listener...
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:254 - Stopping wake word detector...
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:260 - Closing audio stream...
2025-10-17 07:13:04 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:263 - Audio stream closed successfully
2025-10-17 07:13:05 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:269 - Wake word detector stopped
2025-10-17 07:13:05 - subsystem_manager - [INFO] - subsystem_manager.py:304 - Wake word listener stopped
2025-10-17 07:13:05 - root - [INFO] - main_new.py:151 - Waiting 1.0s for audio device release...
2025-10-17 07:13:06 - root - [INFO] - main_new.py:153 - Audio device released, ready for recording
2025-10-17 07:13:06 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in RECORDING
2025-10-17 07:13:06 - root - [INFO] - main_new.py:222 - Starting audio recording process...
2025-10-17 07:13:06 - root - [INFO] - main_new.py:226 - Recording audio...
2025-10-17 07:13:06 - subsystem_manager - [INFO] - subsystem_manager.py:318 - Starting audio recording...
2025-10-17 07:13:06 - audio_recorder - [INFO] - audio_recorder.py:63 - Starting audio recording...
2025-10-17 07:13:06 - audio_recorder - [INFO] - audio_recorder.py:64 - Settings: sample_rate=48000, silence_threshold=2000, silence_duration=1.5s, max_duration=30s
2025-10-17 07:13:06 - audio_recorder - [INFO] - audio_recorder.py:73 - Output file: /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:06 - audio_recorder - [INFO] - audio_recorder.py:82 - Opening audio stream...
2025-10-17 07:13:06 - audio_recorder - [INFO] - audio_recorder.py:91 - Recording started - speak now...
2025-10-17 07:13:06 - audio_recorder - [INFO] - audio_recorder.py:125 - Silence detected (RMS: 560 < 2000)
2025-10-17 07:13:07 - audio_recorder - [INFO] - audio_recorder.py:129 - Silence duration threshold reached (1.55s), stopping recording
2025-10-17 07:13:07 - audio_recorder - [INFO] - audio_recorder.py:145 - Recording stopped
2025-10-17 07:13:07 - audio_recorder - [INFO] - audio_recorder.py:169 - Saving audio to /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:07 - audio_recorder - [INFO] - audio_recorder.py:175 - Audio file saved successfully: /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:07 - audio_recorder - [INFO] - audio_recorder.py:150 - Audio saved: /tmp/voice_kiosk_recordings/recording_1760659986.wav (19 chunks)
2025-10-17 07:13:07 - audio_recorder - [INFO] - audio_recorder.py:161 - Recording cleanup complete
2025-10-17 07:13:07 - subsystem_manager - [INFO] - subsystem_manager.py:321 - Audio recording complete: /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:07 - root - [INFO] - main_new.py:234 - Audio recorded successfully: /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:07 - event_loop - [INFO] - event_loop.py:72 - State transition: RECORDING -> PROCESSING_RECORDING
2025-10-17 07:13:07 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state PROCESSING_RECORDING
2025-10-17 07:13:07 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in PROCESSING_RECORDING
2025-10-17 07:13:07 - root - [INFO] - main_new.py:246 - Transcribing audio...
2025-10-17 07:13:07 - subsystem_manager - [INFO] - subsystem_manager.py:340 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:07 - whisper_service - [INFO] - whisper_service.py:61 - Transcribing audio file: /tmp/voice_kiosk_recordings/recording_1760659986.wav
2025-10-17 07:13:07 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:13:07] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001617
2025-10-17 07:13:07 - faster_whisper - [INFO] - transcribe.py:855 - Processing audio with duration 00:01.621
2025-10-17 07:13:07 - whisper_service - [INFO] - whisper_service.py:104 - Detected language: en (probability: 1.00)
2025-10-17 07:13:09 - whisper_service - [INFO] - whisper_service.py:116 - Transcribed 0 segment(s), total length: 0 chars
2025-10-17 07:13:09 - whisper_service - [INFO] - whisper_service.py:77 - Transcription complete: ''
2025-10-17 07:13:09 - subsystem_manager - [INFO] - subsystem_manager.py:343 - Transcription complete: ''
2025-10-17 07:13:09 - root - [ERROR] - main_new.py:250 - Transcription failed - no text returned
2025-10-17 07:13:09 - root - [ERROR] - main_new.py:271 - Recording error: Could not understand audio
2025-10-17 07:13:09 - event_loop - [INFO] - event_loop.py:72 - State transition: PROCESSING_RECORDING -> IDLE
2025-10-17 07:13:09 - event_loop - [INFO] - event_loop.py:135 - Executing 1 callback(s) for state IDLE
2025-10-17 07:13:09 - root - [INFO] - main_new.py:140 - Entered IDLE state - starting wake word listener
2025-10-17 07:13:09 - root - [INFO] - main_new.py:183 - Starting wake word listener...
2025-10-17 07:13:09 - subsystem_manager - [INFO] - subsystem_manager.py:284 - Starting wake word listener...
2025-10-17 07:13:09 - event_loop - [INFO] - event_loop.py:159 - Creating background task: wake_word_listener
2025-10-17 07:13:09 - subsystem_manager - [INFO] - subsystem_manager.py:290 - Wake word listener started
2025-10-17 07:13:09 - geventwebsocket.handler - [INFO] - handler.py:242 - 127.0.0.1 - - [2025-10-17 07:13:09] "GET /assets/faces/smile_eyes_opened.png HTTP/1.1" 200 38956 0.001889
2025-10-17 07:13:09 - root - [INFO] - main_new.py:210 - Wake word listener started successfully
2025-10-17 07:13:09 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in IDLE
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:250 - Wake word detection stopped
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:163 - Starting improved wake word detection...
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:169 - Opening audio stream (rate: 48000Hz, blocksize: 9600)
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:170 - Software amplification: 2.0x
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:171 - Similarity threshold: 0.6
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:172 - Listening for: 'hal' and variants: ['hal', 'how', 'hall']
2025-10-17 07:13:09 - wake_word_detector_improved - [INFO] - wake_word_detector_improved.py:185 - Wake word detector listening...
2025-10-17 07:13:09 - event_loop - [INFO] - event_loop.py:181 - Background task 'wake_word_listener' completed successfully
2025-10-17 07:13:25 - event_loop - [INFO] - event_loop.py:199 - Idle timeout reached (15.4s), activating screensaver
2025-10-17 07:13:25 - event_loop - [INFO] - event_loop.py:72 - State transition: IDLE -> SCREENSAVER
2025-10-17 07:13:25 - event_loop - [INFO] - event_loop.py:135 - Executing 0 callback(s) for state SCREENSAVER
2025-10-17 07:13:25 - event_loop - [INFO] - event_loop.py:87 - State transition complete: now in SCREENSAVER
